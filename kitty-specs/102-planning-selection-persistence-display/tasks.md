# Work Packages: Planning Selection Persistence Display

**Inputs**: Design documents from `/kitty-specs/102-planning-selection-persistence-display/`
**Prerequisites**: plan.md (required), spec.md (user stories), research.md

**Tests**: Regression tests included — plan.md specifies regression coverage for blank-start and saved-selections paths.

**Organization**: Fine-grained subtasks (`Txxx`) roll up into work packages (`WPxx`). Each work package must be independently deliverable and testable.

**Prompt Files**: Each work package references a matching prompt file in `/tasks/` generated by `/spec-kitty.tasks`. Treat this file as the high-level checklist; keep deep implementation detail inside the prompt files.

## Subtask Format: `[Txxx] [P?] Description`
- **[P]** indicates the subtask can proceed in parallel (different files/components).
- Include precise file paths or modules.

---

## Work Package WP01: Render Saved Selections on Planning Tab Load (Priority: P1)

**Goal**: Add `render_saved_selections()` methods to both RecipeSelectionFrame and FGSelectionFrame, wire them into PlanningTab event loading, and add regression tests to prevent future blank-display regressions.
**Independent Test**: Load an event with saved recipe and FG selections — both frames display saved items immediately with contextual labels. Load an event with no selections — blank placeholders appear as before.
**Prompt**: `/tasks/WP01-render-saved-selections.md`
**Estimated Prompt Size**: ~350 lines

### Included Subtasks
- [ ] T001 [P] Add `render_saved_selections()` method to `RecipeSelectionFrame` in `src/ui/components/recipe_selection_frame.py`
- [ ] T002 [P] Add `render_saved_selections()` method to `FGSelectionFrame` in `src/ui/components/fg_selection_frame.py`
- [ ] T003 Wire conditional render triggers in `PlanningTab._show_recipe_selection()` and `_show_fg_selection()` in `src/ui/planning_tab.py`
- [ ] T004 [P] Add regression tests for blank-start and saved-selections display in `src/tests/`

### Implementation Notes
- T001 and T002 can proceed in parallel (different files, independent frame components)
- T003 depends on T001 and T002 (PlanningTab calls methods added by those subtasks)
- T004 can proceed in parallel once the method signatures from T001/T002 are defined
- All changes are UI-layer only — no service or model modifications
- Total new code: ~60 lines across 3 source files + test file

### Parallel Opportunities
- T001 (recipe frame) and T002 (FG frame) are fully independent — different files, no shared state
- T004 (tests) can be written alongside T001/T002 once method signatures are known

### Dependencies
- None (starting package — no prior WPs)

### Risks & Mitigations
- **Risk**: Contextual label not destroyed when filter applied → stale label remains visible
  - **Mitigation**: Recipe frame's `_render_recipes()` already clears all scroll frame children (line 200-201). FG frame's `_on_filter_change()` already resets `_selected_indicator` (line 280). Both transitions are already handled.
- **Risk**: `session_scope()` call in RecipeSelectionFrame for DB query
  - **Mitigation**: Follows existing pattern from `populate_categories()` (line 137-143) which already uses `session_scope()` within the frame.

---

## Dependency & Execution Summary

- **Sequence**: WP01 is the sole work package — self-contained.
- **Parallelization**: T001 and T002 can proceed in parallel within WP01. T004 can start once method signatures are defined.
- **MVP Scope**: WP01 is the full feature — all 4 user stories addressed in a single package.

---

## Subtask Index (Reference)

| Subtask ID | Summary | Work Package | Priority | Parallel? |
|------------|---------|--------------|----------|-----------|
| T001       | RecipeSelectionFrame.render_saved_selections() | WP01 | P1 | Yes |
| T002       | FGSelectionFrame.render_saved_selections() | WP01 | P1 | Yes |
| T003       | PlanningTab conditional render triggers | WP01 | P1 | No |
| T004       | Regression tests for selection display | WP01 | P1 | Yes |
