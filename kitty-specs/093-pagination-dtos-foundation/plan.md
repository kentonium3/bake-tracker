# Implementation Plan: Pagination DTOs Foundation

**Branch**: `093-pagination-dtos-foundation` | **Date**: 2026-02-03 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/kitty-specs/093-pagination-dtos-foundation/spec.md`

## Summary

Create minimal pagination infrastructure (PaginationParams and PaginatedResult[T] dataclasses) for future web API migration readiness. This is foundation-only: no service refactoring, no UI changes, just type-safe data structures and documentation.

## Technical Context

**Language/Version**: Python 3.10+ (matching existing project)
**Primary Dependencies**: None (uses stdlib dataclasses and typing)
**Storage**: N/A (DTOs only, no database changes)
**Testing**: pytest (existing test infrastructure)
**Target Platform**: Desktop (CustomTkinter) - DTOs ready for future web
**Project Type**: Single (existing bake-tracker structure)
**Performance Goals**: N/A (data structures only)
**Constraints**: Zero impact on existing desktop functionality
**Scale/Scope**: ~40 lines of DTO code, ~50 lines of documentation

## Constitution Check

*GATE: Minimal infrastructure feature - passes all constitution principles.*

- **Principle VI.F (Migration Readiness)**: ✅ DTOs enable future web migration
- **YAGNI Principle**: ✅ Minimal foundation (4 hours) vs full refactor (weeks)
- **Layered Architecture**: ✅ DTOs in services layer, no cross-layer violations

No violations - proceed to implementation.

## Project Structure

### Documentation (this feature)

```
kitty-specs/093-pagination-dtos-foundation/
├── spec.md              # Feature specification
├── plan.md              # This file
└── tasks.md             # Task tracking (generated by /spec-kitty.tasks)
```

### Source Code (repository root)

```
src/
├── services/
│   ├── dto.py           # NEW: PaginationParams, PaginatedResult[T]
│   └── ...
└── tests/
    └── services/
        └── test_dto.py  # NEW: Unit tests for DTOs
```

**Structure Decision**: Add dto.py to existing services/ directory. This follows the established pattern and keeps pagination infrastructure with other service-layer code.

## Implementation Approach

### Phase 1: Create DTOs (2 hours)

1. Create `src/services/dto.py`
2. Add `PaginationParams` dataclass:
   - Fields: page (int, default 1), per_page (int, default 50)
   - Method: offset() -> int
   - Validation: page >= 1, 1 <= per_page <= 1000
3. Add `PaginatedResult[T]` generic dataclass:
   - Fields: items (List[T]), total (int), page (int), per_page (int)
   - Properties: pages, has_next, has_prev
4. Comprehensive docstrings with desktop vs web examples

### Phase 2: Unit Tests (1 hour)

1. Create `src/tests/services/test_dto.py`
2. Test offset() calculation (page 1 → 0, page 2 → 50)
3. Test pages property (edge cases: 0 items, exact division, remainder)
4. Test has_next/has_prev (first page, last page, middle page)
5. Test validation errors (page < 1, per_page > 1000)

### Phase 3: Documentation (1 hour)

1. Add "Pagination Pattern (Web Migration Ready)" section to CLAUDE.md
2. Document optional pagination pattern
3. Provide desktop vs web usage examples
4. Reference web-prep/F003 for future full adoption

## Key Files

| File | Purpose | Action |
|------|---------|--------|
| `src/services/dto.py` | Pagination DTOs | CREATE |
| `src/tests/services/test_dto.py` | Unit tests | CREATE |
| `CLAUDE.md` | Usage documentation | UPDATE |

## Risks & Mitigations

| Risk | Likelihood | Mitigation |
|------|------------|------------|
| DTOs never adopted | Low | Document in CLAUDE.md, reference from architecture docs |
| Inconsistent adoption | Low | Clear examples, code review checklist |
| Premature optimization | Mitigated | MINIMAL infrastructure (~40 lines), easy to remove |

## Dependencies

- None - this is a standalone foundation feature
- Does NOT depend on any other features
- Future features (web-prep/F003) will depend on this

## Non-Goals (Explicitly Excluded)

- ❌ Refactoring existing service functions
- ❌ Updating UI components
- ❌ Backward-compatible wrappers
- ❌ Query optimization or caching
- ❌ Cursor-based pagination
