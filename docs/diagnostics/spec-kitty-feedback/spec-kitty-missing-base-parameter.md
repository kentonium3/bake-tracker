# spec-kitty Bug Report: Missing --base Parameter in Implement Command

**Date:** 2026-01-24
**Version:** spec-kitty-cli 0.12.0
**Severity:** High - Blocks sequential WP workflow
**Reporter:** Claude Opus (via Kent Gale)

## Summary

The `--base` parameter is documented in generated WP prompt files but does not exist in the CLI implementation, preventing proper workflow for features with sequential work packages that depend on each other.

## Command Attempted

```bash
spec-kitty agent workflow implement WP04 --base WP03 --agent claude-opus
```

## Error Message

```
Usage: spec-kitty agent workflow implement [OPTIONS] [WP_ID]
Try 'spec-kitty agent workflow implement --help' for help.
╭─ Error ──────────────────────────────────────────────────────────────────────╮
│ No such option: --base Did you mean --agent?                                 │
╰──────────────────────────────────────────────────────────────────────────────╯
```

## Available Options (from --help)

```
╭─ Options ────────────────────────────────────────────────────────────────────╮
│ --feature        TEXT  Feature slug (auto-detected if omitted)               │
│ --agent          TEXT  Agent name (required for auto-move to doing lane)     │
│ --help                 Show this message and exit.                           │
╰──────────────────────────────────────────────────────────────────────────────╯
```

## Documentation vs Implementation Mismatch

The WP03 prompt file (generated by `/spec-kitty.tasks`) contains:

```markdown
**Implementation Command**:
```bash
spec-kitty implement WP03 --base WP02
```
(Note: Assumes WP01 and WP02 are both merged. Use the latest merged WP as base.)
```

This suggests the `--base` parameter should exist but was either:
1. Never implemented
2. Removed without updating the prompt templates
3. Intended for a future release

## Reproduction Steps

1. Create a feature with multiple WPs where later WPs depend on earlier ones
2. Complete WP01-WP03 in their respective branches (not yet merged to main)
3. Attempt to start WP04 with: `spec-kitty agent workflow implement WP04 --base WP03 --agent claude-opus`
4. Command fails with "No such option: --base"

## Impact

**Critical for multi-WP features:**

- Feature 064 has WP01 → WP02 → WP03 → WP04 dependency chain
- WP03 worktree contains accumulated code from WP01 + WP02 + WP03
- WP04 cannot be started via normal workflow because main branch lacks WP01-WP03 code
- Agents must manually create worktrees with git commands, breaking the spec-kitty workflow

**Workflow Break:**

Without `--base`, agents are forced to either:
1. Merge all preceding WPs to main before starting dependent WPs (defeats parallel development)
2. Manually create worktrees with git commands (breaks workflow consistency)

## Expected Behavior

```bash
spec-kitty agent workflow implement WP04 --base WP03 --agent claude-opus
```

Should:
1. Create WP04 worktree branched from the WP03 branch (not main)
2. Move WP04 to "doing" lane
3. Output the WP04 prompt with implementation instructions

## Current Workaround

Manual git worktree creation:
```bash
# From main repo
git worktree add .worktrees/FEATURE-WP04 -b FEATURE-WP04 FEATURE-WP03
cd .worktrees/FEATURE-WP04
# Then manually move WP04 to doing lane
spec-kitty agent tasks move-task WP04 --to doing --agent claude-opus
```

## Suggested Fix

Add `--base` option to the implement command:

```python
@click.option('--base', type=str, default=None,
              help='Base WP branch to create worktree from (e.g., WP03)')
```

When `--base` is provided:
- Create worktree from `FEATURE-WP##` branch instead of main
- Validate that base WP exists and is in done/for_review lane

## Related Issues

This may be related to the template/CLI mismatch pattern documented in:
- `spec-kitty-template-cli-mismatch.md`
- `spec-kitty-wrong-params.md`

## Environment

- OS: macOS Darwin 25.2.0
- Python: 3.13.11
- spec-kitty-cli: 0.12.0
- Feature: 064-finishedgoods-snapshot-architecture
